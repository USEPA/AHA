
 CREATE TABLE ACCOUNT_COMPLIANCE_DIM
    (
    ACCOUNT_NUMBER VARCHAR(120) NOT NULL,
    PRG_CODE VARCHAR(120) NOT NULL,
    OP_YEAR INTEGER NOT NULL,
    UNITS_AFFECTED VARCHAR(400),
    ALLOCATED INTEGER,
    TOTAL_HELD INTEGER,
    BANKED_HELD INTEGER,
    CURRENT_HELD INTEGER,
    COMP_YEAR_EMISS INTEGER,
    OTHER_DEDUCT INTEGER,
    CURRENT_DEDUCT INTEGER,
    DEDUCT_1_1 INTEGER,
    DEDUCT_2_1 INTEGER,
    DEDUCT_286_1 INTEGER,
    TOTAL_DEDUCT INTEGER, 
    CARRIED_OVER INTEGER,
    EXCESS_EMISS INTEGER,
    PENALTY_AMOUNT INTEGER,
    PENALTY_DEDUCT_INFO VARCHAR(400),
    TOTAL_REQ_DEDUCT INTEGER,
    ADD_DATE DATE,
    USERID VARCHAR(120) NOT NULL,
    DATA_SOURCE VARCHAR(120) NOT NULL,
    constraint year_account_pk PRIMARY KEY(ACCOUNT_NUMBER, PRG_CODE, OP_YEAR)
    ); 


CREATE TABLE ACCOUNT_FACT
(
 ACCOUNT_NUMBER VARCHAR(120) NOT NULL,
 PRG_CODE VARCHAR(120) NOT NULL,
 ACCOUNT_NAME VARCHAR(400) NOT NULL,
 ACCOUNT_TYPE VARCHAR(120) NOT NULL,         
 UNIT_ID VARCHAR(120),
 UNITID VARCHAR(120),
 OP_STATUS_INFO VARCHAR(120) ,
 PRIMARY_FUEL_INFO VARCHAR(120) ,    
 SECONDARY_FUEL_INFO VARCHAR(120) ,
 OWN_DISPLAY VARCHAR(800),
 UNIT_TYPE_INFO VARCHAR(800),
 PRM_DISPLAY_NAME VARCHAR(800),
 PRM_DISPLAY_BLOCK VARCHAR(800),
 ALT_DISPLAY_NAME VARCHAR(800),
 ALT_DISPLAY_BLOCK VARCHAR(800),
 EPA_REGION INT,           
EPA_REGION_DESCRIPTION VARCHAR(400),
STATE CHAR(2),
STATE_NAME VARCHAR(120),
SOURCE_CAT VARCHAR(120),           
FAC_ID VARCHAR(120),
FACILITY_NAME VARCHAR(400),
ORISPL_CODE VARCHAR(120),
PHASE1_ALLOCATION INT,
PHASE2A_ALLOCATION INT,
PHASE2B_ALLOCATION INT,
DATA_SOURCE VARCHAR(120),
ADD_DATE DATE NOT NULL,
USERID VARCHAR(120),
SO2_CONTROL_INFO VARCHAR(400),
NOX_CONTROL_INFO VARCHAR(400),
PART_CONTROL_INFO VARCHAR(400),     
NERC_REGION VARCHAR(120),
NERC_DESCRIPTION VARCHAR(400),
ACCOUNT_TYPE_CODE VARCHAR(120),
OP_STATUS VARCHAR(120),
CONSTRAINT prg_account_pk PRIMARY KEY(ACCOUNT_NUMBER, PRG_CODE)
  );

CREATE TABLE TRANSACTION_FACT
(
 TRANSACTION_ID  NUMERIC(10)    NOT NULL,
 PRG_CODE VARCHAR(120) NOT NULL,
 TRANSACTION_DATE DATE NOT NULL,
 TRANSACTION_TYPE_CODE VARCHAR(120) NOT NULL,
 TRANSACTION_TYPE VARCHAR(120) NOT NULL,
 TRANSACTION_TOTAL INTEGER NOT NULL,
 BUY_ACCT_NUMBER VARCHAR(120) NOT NULL,
 BUY_PPL_ID VARCHAR(400),
 BUY_DISPLAY_NAME VARCHAR(400),
 BUY_DISPLAY_BLOCK VARCHAR(1000),
 BUY_OWN_DISPLAY_NAME VARCHAR(2000),
 BUY_SOURCE_CAT VARCHAR(120),       
BUY_EPA_REGION INTEGER,
BUY_STATE CHAR(2),
BUY_ORISPL_CODE VARCHAR(120),
BUY_FACILITY_NAME VARCHAR(400),
SELL_ACCT_NUMBER VARCHAR(120) NOT NULL,
SELL_PPL_ID VARCHAR(400) ,
SELL_EPA_REGION INTEGER,
SELL_SOURCE_CAT VARCHAR(120),
SELL_STATE CHAR(2),
SELL_ORISPL_CODE VARCHAR(120),
SELL_FACILITY_NAME VARCHAR(400),
SELL_DISPLAY_NAME VARCHAR(400),
SELL_DISPLAY_BLOCK VARCHAR(1000),
SELL_OWN_DISPLAY_NAME VARCHAR(2000),
DATA_SOURCE VARCHAR(120),
USERID VARCHAR(120),
ADD_DATE DATE,
BUY_FAC_ID VARCHAR(120),
SELL_FAC_ID VARCHAR(120),
BUY_ACCT_NAME VARCHAR(120),
SELL_ACCT_NAME VARCHAR(120),
BUY_FULL_NAME VARCHAR(120),
SELL_FULL_NAME VARCHAR(120),
BUY_NERC_REGION VARCHAR(120),
SELL_NERC_REGION VARCHAR(120),
BUY_ACCOUNT_TYPE VARCHAR(120),
SELL_ACCOUNT_TYPE VARCHAR(120), 
BUY_ACCOUNT_TYPE_CODE VARCHAR(120),
SELL_ACCOUNT_TYPE_CODE VARCHAR(120),
BUY_UNIT_ID VARCHAR(120),         
SELL_UNIT_ID  VARCHAR(120),      
CONSTRAINT trans_ID_prg_cd_pk PRIMARY KEY(PRG_CODE, TRANSACTION_ID)
);

CREATE TABLE FACILITY_SS
(
FAC_ID  VARCHAR(120) PRIMARY KEY,                                                                        
ORIS_CODE  VARCHAR(120),                                                                     
FACILITY_NAME VARCHAR(120) NOT NULL,                                                                  
DESCRIPTION TEXT,                                                                  
STATE CHAR(2),                                                                          
COUNTY_CD VARCHAR(120),                                                                      
SIC_CODE  VARCHAR(120),                                                                      
EPA_REGION INTEGER,                                                                   
NERC_REGION VARCHAR(120),                                                                  
AIRSID VARCHAR(120),                                                                      
FINDSID VARCHAR(120),                                                                  
STATEID VARCHAR(120),                                                                  
LATITUDE VARCHAR(120),                                                                  
LONGITUDE VARCHAR(120),                                                                  
USERID VARCHAR(120),                                                                    
ADD_DATE DATE,                                                                       
UPDATE_DATE DATE,                                                                  
FRS_ID  VARCHAR(120),                                                                        
PAYEE_ID VARCHAR(120),                                                                    
PERMIT_EXP_DATE DATE,                                                            
LATLON_SOURCE VARCHAR(120),
TRIBAL_LAND_CD VARCHAR(120)
);

CREATE TABLE UNIT_FACT
(
  UNIT_ID                                           NUMERIC(12) NOT NULL,                  
 OP_YEAR                                            NUMERIC(4) NOT NULL,                   
 FAC_ID                                             NUMERIC(12),                  
 FACILITY_NAME                                      VARCHAR(120),                
 ORISPL_CODE                                        NUMERIC(6),                   
 UNITID                                             VARCHAR(6),                 
 COUNTY_CODE                                        VARCHAR(8),                 
 COUNTY                                             VARCHAR(45),                
 FIPS_CODE                                          VARCHAR(30),                 
 COMM_OP_DATE                                       DATE,                        
 COMR_OP_DATE                                       DATE ,                       
 SOURCE_CAT                                         VARCHAR(1000),              
 CAPACITY_INPUT                                     NUMERIC(7),                 
 CAPACITY_OUTPUT                                    NUMERIC(7),                 
 STATE                                              CHAR(2),                     
 STATE_NAME                                         VARCHAR(20),                
 LATITUDE                                           NUMERIC(7,4),                 
 LONGITUDE                                          NUMERIC(8,4),                 
 EPA_REGION                                         NUMERIC(2),                   
 EPA_REGION_DESCRIPTION                             VARCHAR(1000),              
 NAICS_CODE                                         NUMERIC(6),                   
 NAIC_CODE_DESCRIPTION                              VARCHAR(1000),              
 SIC_CODE                                           NUMERIC(4),                   
 SIC_CODE_DESCRIPTION                               VARCHAR(1000),              
 NERC_REGION                                        VARCHAR(7),                 
 NERC_DESCRIPTION                                   VARCHAR(1000),              
 PRG_CODE_INFO                                      VARCHAR(1000),              
 OP_STATUS_INFO                                     VARCHAR(1000),              
 PRIMARY_FUEL_INFO                                  VARCHAR(1000),              
 SECONDARY_FUEL_INFO                                VARCHAR(1000),              
 UNIT_TYPE_INFO                                     VARCHAR(1000),              
 DATA_SOURCE                                        VARCHAR(35),                
 ADD_DATE                                           DATE,                        
 USERID                                             VARCHAR(8),                 
 SO2_CONTROL_INFO                                   VARCHAR(1000),              
 NOX_CONTROL_INFO                                   VARCHAR(1000),              
 PART_CONTROL_INFO                                  VARCHAR(1000),              
 NOX_PHASE                                          VARCHAR(1000),              
 SO2_PHASE                                          VARCHAR(1000),              
 ASSOC_STACKS                                       VARCHAR(250), 
 CONSTRAINT unit_id_op_year_pk PRIMARY KEY(UNIT_ID, OP_YEAR)          
);


CREATE TABLE OZONE_UNIT_DATA
(
   UNIT_ID                                    NUMERIC(12) NOT NULL,                  
 OP_YEAR                                   NUMERIC(4)  NOT NULL ,                 
 COUNT_OP_TIME                                      NUMERIC(10) ,                 
 SUM_OP_TIME                                        NUMERIC(10,2),                
 GLOAD                                              NUMERIC(12,2),                
 SLOAD                                              NUMERIC(12,2),                
 TLOAD                                              NUMERIC(12,2),                
 HEAT_INPUT                                         NUMERIC(15,3),                
 SO2_MASS                                           NUMERIC(12,3),                
 SO2_MASS_LBS                                       NUMERIC(15,3),                
 SO2_RATE                                           NUMERIC(16,4),                
 SO2_RATE_SUM                                       NUMERIC(15,3) ,               
 SO2_RATE_COUNT                                     NUMERIC(4) ,                  
 CO2_MASS                                           NUMERIC(12,3) ,               
 CO2_RATE                                           NUMERIC(16,4),                
 CO2_RATE_SUM                                       NUMERIC(15,3),                
 CO2_RATE_COUNT                                     NUMERIC(4),                   
 NOX_MASS                                           NUMERIC(12,3) ,               
 NOX_MASS_LBS                                       NUMERIC(15,3),                
 NOX_RATE                                           NUMERIC(16,4),                
 NOX_RATE_SUM                                       NUMERIC(15,3) ,               
 NOX_RATE_COUNT                                     NUMERIC(4) ,                  
 NUM_MONTHS_REPORTED                               NUMERIC ,                    
 DATA_SOURCE                                        VARCHAR(35) ,               
 USERID                                             VARCHAR(8)  ,               
 ADD_DATE                                           DATE ,
 CONSTRAINT os_unit_id_op_year_pk PRIMARY KEY(UNIT_ID, OP_YEAR)       
);


CREATE TABLE ANNUAL_UNIT_DATA
(

 UNIT_ID                                            NUMERIC(12)  NOT NULL,                
 OP_YEAR                                            NUMERIC(4)    NOT NULL,                
 COUNT_OP_TIME                                      NUMERIC(10),                  
 SUM_OP_TIME                                        NUMERIC(10,2),                
 GLOAD                                              NUMERIC(12,2) ,               
 SLOAD                                              NUMERIC(12,2),                
 TLOAD                                              NUMERIC(12,2),                
 HEAT_INPUT                                         NUMERIC(15,3),                
 SO2_MASS                                           NUMERIC(12,3) ,               
 SO2_MASS_LBS                                       NUMERIC(15,3)  ,              
 SO2_RATE                                           NUMERIC(16,4) ,               
 SO2_RATE_SUM                                       NUMERIC(15,3) ,               
 SO2_RATE_COUNT                                     NUMERIC(4)   ,                
 CO2_MASS                                           NUMERIC(12,3) ,               
 CO2_RATE                                           NUMERIC(16,4) ,               
 CO2_RATE_SUM                                       NUMERIC(15,3) ,               
 CO2_RATE_COUNT                                     NUMERIC(4)  ,                 
 NOX_MASS                                           NUMERIC(12,3) ,               
 NOX_MASS_LBS                                       NUMERIC(15,3) ,               
 NOX_RATE                                           NUMERIC(16,4) ,               
 NOX_RATE_SUM                                       NUMERIC(15,3)  ,              
 NOX_RATE_COUNT                                     NUMERIC(4)   ,                
 NUM_MONTHS_REPORTED                                NUMERIC     ,                 
 DATA_SOURCE                                        VARCHAR(35)  ,              
 USERID                                             VARCHAR(8),
 ADD_DATE                                           DATE ,

  CONSTRAINT an_unit_id_op_year_pk PRIMARY KEY(UNIT_ID, OP_YEAR)     
);

CREATE TABLE PROGRAM_YEAR_DIM
(
 UNIT_ID                                            NUMERIC(12) NOT NULL,                  
 PRG_CODE                                           VARCHAR(8) NOT NULL,                
 PROGRAM_DESCRIPTION                                VARCHAR(1000) ,             
 OP_YEAR                                            NUMERIC(4) NOT NULL  ,                
 REPORT_FREQ                                        VARCHAR(2),                 
 DATA_SOURCE                                        VARCHAR(35)   ,             
 USERID                                             VARCHAR(8) ,                
 ADD_DATE                                           DATE  ,                      
 NON_EGU_FLG                                        VARCHAR(8)    ,             
 COMPLIANCE_IND                                     NUMERIC ,

CONSTRAINT unit_prg_year_pk PRIMARY KEY(UNIT_ID, PRG_CODE, OP_YEAR)
);

CREATE TABLE TRANSACTION_BLOCK_DIM
(
TRANSACTION_BLOCK_ID                       NUMERIC(10)    PRIMARY KEY,              
 TRANSACTION_ID                             NUMERIC(10)    NOT NULL,              
 START_BLOCK                                        NUMERIC(10)  ,                
 END_BLOCK                                          NUMERIC(10),                  
 ORIGINATING_ACCT_NUMBER                            VARCHAR(12),                
 ORIGINATING_PARTY                                  VARCHAR(35),                
 TOTAL_BLOCK                                        NUMERIC(10),                  
 VINTAGE_YEAR                                       NUMERIC(4),                   
 DATA_SOURCE                                        VARCHAR(35),                
 USERID                                             VARCHAR(8) ,                
 ADD_DATE                                           DATE,                        
 PRG_CODE                                   VARCHAR(8)   NOT NULL,              
 BLOCK_PRG_CODE                                     VARCHAR(8),                 
 ALLOWANCE_TYPE                                     VARCHAR(35) ,               
 ALLOWANCE_TYPE_CODE                                VARCHAR(3)                 
);

CREATE TABLE OP_STATUS_YEAR_DIM
(
 UNIT_ID                                            NUMERIC(12) NOT NULL,                  
 OP_YEAR                                            NUMERIC(4),                   
 OP_STATUS                                          VARCHAR(7),                 
 OP_STATUS_DESCRIPTION                              VARCHAR(30),                
 DATA_SOURCE                                        VARCHAR(35) ,               
 USERID                                             VARCHAR(8) ,                
 ADD_DATE                                           DATE                        
);